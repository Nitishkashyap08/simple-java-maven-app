pipeline{
    agent{label 'agent-server'}
    tools{
        maven 'mymaven'
    }
    stages{
        stage('clean'){
            steps{
                sh 'mvn clean install'
            }
        }
        stage('parallel steps'){
            parallel{
                stage('unit test'){
                steps{
                    sh 'mvn test -Dtest=UnitTest*'
                }
            }
            
            stage('integratio'){
                steps{
                    sh 'mvn test -Dtest=IntegrationTest*'
                }
            }
        }
        }
        stage('deploy'){
            steps{
                dir('jenkins'){
                    sh 'chmod +x deploy.sh'
                    sh './deploy.sh'
                }
            }
        }
    }
}